# Frontend Service (Next.js)
# Port: 5110

services:
  frontend:
    build:
      context: ../../../
      dockerfile: frontend/Dockerfile
      target: development
    image: frontend:dev
    container_name: frontend
    restart: unless-stopped
    command: ["npm", "run", "dev"]
    ports:
      - "5110:5110"
    # 핫 리로드를 위한 볼륨 마운트 (개발 환경)
    volumes:
      - ../../../frontend:/app/frontend:delegated
    # 환경 변수를 설정하지 않고 코드에서 동적으로 결정 (외부 도메인 지원)
    # 외부 도메인: https://ralphpark.com → https://ralphpark.com:5111
    # 로컬 도메인: http://localhost:5110 → http://localhost:5111
    healthcheck:
      test: ["CMD", "wget", "--spider", "-q", "http://localhost:5110"]
      interval: 30s
      timeout: 10s
      start_period: 60s
      retries: 3
    networks:
      - ralph-network
